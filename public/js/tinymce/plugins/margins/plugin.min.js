function loadFailure() {
    alert("Не удалось загрузить изображение");
    return true;
}
tinymce.PluginManager.add("margins",function(a,b){

    a.addButton("margins",{
        text:"Отступы",
        icon:"",
        onclick:function(){
            var node = a.selection.getNode();
            var top = parseInt($(node).css("marginTop"));
            var left = parseInt($(node).css("marginLeft"));
            var right = parseInt($(node).css("marginRight"));
            var bottom = parseInt($(node).css("marginBottom"));

            a.windowManager.open(
                {
                    title:"Установка отступов",
                    bodyType: 'tabpanel',
                    body: [
                        {
                            title: 'General',
                            type: 'form',
                            items: [
                                {name: 'top', value:top, type: 'textbox', label: 'Сверху'},
                                {name: 'right', value:right, type: 'textbox', label: 'Справа'},
                                {name: 'bottom', value:bottom, type: 'textbox', label: 'Снизу'},
                                {name: 'left', value:left, type: 'textbox', label: 'Слева'},
                            ]
                        },
                    ],

                    width: 500,
                    height: 200,
                    inline: 1,
                    onSubmit: function(e){
                        a.execCommand('mceInsertContent', false, node);
                        //a.setContent("<div>"+node+"</div>",{format : 'text'})//
                        a.windowManager.close()
                   //     $(node).css({"marginTop":e.data.top+"px"});
                    }
                }, {
                    plugin_url: b

                })
        }
    });
});
